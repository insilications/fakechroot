From e6ce10f50726ac926b9e90710117e8be6c8c8074 Mon Sep 17 00:00:00 2001
From: Christopher Yeleighton <ne01026@shark.2a.pl>
Date: Thu, 29 Apr 2021 15:06:53 +0200
Subject: [PATCH 1/7] build action

---
 .github/workflows/c-cpp.yml | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)
 create mode 100644 .github/workflows/c-cpp.yml

diff --git a/.github/workflows/c-cpp.yml b/.github/workflows/c-cpp.yml
new file mode 100644
index 0000000..e323326
--- /dev/null
+++ b/.github/workflows/c-cpp.yml
@@ -0,0 +1,23 @@
+name: C/C++ CI
+
+on:
+  push:
+    branches: [ master ]
+  pull_request:
+    branches: [ master ]
+
+jobs:
+  build:
+
+    runs-on: ubuntu-latest
+
+    steps:
+    - uses: actions/checkout@v2
+    - name: configure
+      run: ./configure
+    - name: make
+      run: make
+    - name: make check
+      run: make check
+    - name: make distcheck
+      run: make distcheck

From aedcacc4c3703d34d829a3d77cf8382d445b6429 Mon Sep 17 00:00:00 2001
From: Christopher Yeleighton <ne01026@shark.2a.pl>
Date: Thu, 29 Apr 2021 15:08:54 +0200
Subject: [PATCH 2/7] autogen.sh

---
 .github/workflows/c-cpp.yml | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/.github/workflows/c-cpp.yml b/.github/workflows/c-cpp.yml
index e323326..ac02906 100644
--- a/.github/workflows/c-cpp.yml
+++ b/.github/workflows/c-cpp.yml
@@ -14,7 +14,10 @@ jobs:
     steps:
     - uses: actions/checkout@v2
     - name: configure
-      run: ./configure
+      run: |
+        for t in autogen.sh configure
+        do sh "$t"
+        done
     - name: make
       run: make
     - name: make check

From 1cb53cfadf5f1dff1d46d27716e35b53c89cdb9d Mon Sep 17 00:00:00 2001
From: Christopher Yeleighton <ne01026@shark.2a.pl>
Date: Thu, 29 Apr 2021 15:23:25 +0200
Subject: [PATCH 3/7] upload test log

---
 .github/workflows/c-cpp.yml | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/.github/workflows/c-cpp.yml b/.github/workflows/c-cpp.yml
index ac02906..0d46b93 100644
--- a/.github/workflows/c-cpp.yml
+++ b/.github/workflows/c-cpp.yml
@@ -24,3 +24,9 @@ jobs:
       run: make check
     - name: make distcheck
       run: make distcheck
+      continue-on-error: true
+    - name: upload test log
+      uses: actions/upload-artifact@v2.2.3
+      with:
+        name: test-log
+        path: test/test-suite.log

From bca711379020d17a26a3c2c313a11aa28c6d9653 Mon Sep 17 00:00:00 2001
From: Christopher Yeleighton <ne01026@shark.2a.pl>
Date: Fri, 30 Apr 2021 09:16:01 +0200
Subject: [PATCH 4/7] path: fakechroot-2.20.2/_build/sub/

---
 .github/workflows/c-cpp.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/.github/workflows/c-cpp.yml b/.github/workflows/c-cpp.yml
index 0d46b93..cc65f07 100644
--- a/.github/workflows/c-cpp.yml
+++ b/.github/workflows/c-cpp.yml
@@ -29,4 +29,4 @@ jobs:
       uses: actions/upload-artifact@v2.2.3
       with:
         name: test-log
-        path: test/test-suite.log
+        path: fakechroot-2.20.2/_build/sub/test/test-suite.log

From 953fed82a2fff84c7f7ebed09eee1cddeb8578a3 Mon Sep 17 00:00:00 2001
From: Christopher Yeleighton <ne01026@shark.2a.pl>
Date: Fri, 30 Apr 2021 09:18:08 +0200
Subject: [PATCH 5/7] branches: [ fix-dist-check ]

---
 .github/workflows/c-cpp.yml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/.github/workflows/c-cpp.yml b/.github/workflows/c-cpp.yml
index cc65f07..38ec05a 100644
--- a/.github/workflows/c-cpp.yml
+++ b/.github/workflows/c-cpp.yml
@@ -2,7 +2,7 @@ name: C/C++ CI
 
 on:
   push:
-    branches: [ master ]
+    branches: [ fix-dist-check ]
   pull_request:
     branches: [ master ]
 

From e1a5c99000d932df43125fd444d82691948680fd Mon Sep 17 00:00:00 2001
From: Christopher Yeleighton <ne01026@shark.2a.pl>
Date: Fri, 30 Apr 2021 10:19:10 +0200
Subject: [PATCH 6/7] cd "../.."

---
 test/bin/fakechroot | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/test/bin/fakechroot b/test/bin/fakechroot
index 315cb10..4904d33 100755
--- a/test/bin/fakechroot
+++ b/test/bin/fakechroot
@@ -1,7 +1,7 @@
 #!/bin/sh
 
 pwd=`dirname $0`
-abs_top_srcdir=${abs_top_srcdir:-`cd "$pwd/../.." 2>/dev/null && pwd -P`}
+abs_top_srcdir=${abs_top_srcdir:-`cd "../.." 2>/dev/null && pwd -P`}
 
 PATH="/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin"
 export PATH

From a854440ba208892435f00461024a0a0cfb7168c1 Mon Sep 17 00:00:00 2001
From: Christopher Yeleighton <ne01026@shark.2a.pl>
Date: Fri, 30 Apr 2021 10:22:10 +0200
Subject: [PATCH 7/7] cd ".."

---
 test/bin/fakechroot | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/test/bin/fakechroot b/test/bin/fakechroot
index 4904d33..122c991 100755
--- a/test/bin/fakechroot
+++ b/test/bin/fakechroot
@@ -1,7 +1,7 @@
 #!/bin/sh
 
 pwd=`dirname $0`
-abs_top_srcdir=${abs_top_srcdir:-`cd "../.." 2>/dev/null && pwd -P`}
+abs_top_srcdir=${abs_top_srcdir:-`cd ".." 2>/dev/null && pwd -P`}
 
 PATH="/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin"
 export PATH
